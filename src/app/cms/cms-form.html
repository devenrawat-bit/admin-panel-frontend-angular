<div class="cms-container">
  <h2>{{ mode === 'add' ? 'Add CMS' : 'Edit CMS' }}</h2>

  <!-- Success Message -->
  <div class="alert alert-success" *ngIf="successMessage">
    <i class="fa-solid fa-circle-check"></i>
    {{ successMessage }}
  </div>

  <form [formGroup]="form" (ngSubmit)="submit()">

    <!-- KEY -->
    <div class="form-group">
      <label>Key*</label>
      <input
        type="text"
        formControlName="key"
        placeholder="Enter unique key (e.g., about-us)"
        maxlength="50"
        class="form-control"
        (input)="onKeyInput()"
        (blur)="onKeyBlur()"
        [ngClass]="{
          'is-invalid': form['controls']['key'].touched &&
                        form['controls']['key'].invalid
        }"
      />

      <div class="error" *ngIf="form['controls']['key'].touched &&
                               form['controls']['key'].hasError('required')">
        Key is required
      </div>
      <div class="error" *ngIf="form['controls']['key'].touched &&
                               form['controls']['key'].hasError('minlength')">
        Key must be at least 2 characters
      </div>
      <div class="error" *ngIf="form['controls']['key'].touched &&
                               form['controls']['key'].hasError('maxlength')">
        Key cannot exceed 50 characters
      </div>
      <div class="error" *ngIf="form['controls']['key'].touched &&
                               form['controls']['key'].hasError('pattern')">
        Key can only contain letters, numbers, hyphens, and underscores
      </div>
    </div>

    <!-- TITLE -->
    <div class="form-group">
      <label>Title*</label>
      <input
        type="text"
        formControlName="title"
        placeholder="Enter page title"
        maxlength="100"
        class="form-control"
        (input)="onTitleInput()"
        (blur)="onTitleBlur()"
        [ngClass]="{
          'is-invalid': form['controls']['title'].touched &&
                        form['controls']['title'].invalid
        }"
      />

      <div class="error" *ngIf="form['controls']['title'].touched &&
                               form['controls']['title'].hasError('required')">
        Title is required
      </div>
      <div class="error" *ngIf="form['controls']['title'].touched &&
                               form['controls']['title'].hasError('minlength')">
        Title must be at least 3 characters
      </div>
      <div class="error" *ngIf="form['controls']['title'].touched &&
                               form['controls']['title'].hasError('maxlength')">
        Title cannot exceed 100 characters
      </div>
    </div>

    <!-- META KEYWORD -->
    <div class="form-group">
      <label>Meta Keyword*</label>
      <input
        type="text"
        formControlName="metaKeyword"
        placeholder="Enter meta keywords (comma separated)"
        maxlength="200"
        class="form-control"
        (blur)="onMetaKeywordBlur()"
        [ngClass]="{
          'is-invalid': form['controls']['metaKeyword'].touched &&
                        form['controls']['metaKeyword'].invalid
        }"
      />

      <div class="error" *ngIf="form['controls']['metaKeyword'].touched &&
                               form['controls']['metaKeyword'].hasError('required')">
        Meta keyword is required
      </div>
      <div class="error" *ngIf="form['controls']['metaKeyword'].touched &&
                               form['controls']['metaKeyword'].hasError('maxlength')">
        Meta keyword cannot exceed 200 characters
      </div>
    </div>

    <!-- STATUS -->
    <div class="form-group">
      <label>Status*</label>
      <select formControlName="isActive" class="form-control">
        <option [value]="true">Active</option>
        <option [value]="false">Inactive</option>
      </select>
    </div>

    <!-- CONTENT (CKEditor) -->
    <div class="form-group">
      <label>Content*</label>

      <ckeditor
        [editor]="Editor"
        [config]="editorConfig"
        formControlName="content"
        (ready)="onEditorReady($event)"
        (blur)="onContentBlur()"
      ></ckeditor>

      <div class="error" *ngIf="form['controls']['content'].touched &&
                               form['controls']['content'].invalid">
        Content is required
      </div>
    </div>

    <!-- ACTION BUTTONS -->
    <div class="btn-row">
      <button type="button" class="btn btn-secondary" (click)="cancel()">
        Cancel
      </button>

      <button type="submit" class="btn btn-primary" [disabled]="saving">
        {{ saving ? 'Saving...' : mode === 'add' ? 'Create' : 'Update' }}
      </button>
    </div>
  </form>
</div>
