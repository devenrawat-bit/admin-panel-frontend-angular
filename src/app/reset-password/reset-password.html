<div class="reset-password-container">
  <div class="reset-password-card">
    <div class="logo-section">
      <i class="fa-solid fa-key"></i>
    </div>

    <h2>Reset Password</h2>
    <p class="subtitle">Enter your new password below.</p>

    <form [formGroup]="resetPasswordForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label>New Password</label>
        <div class="password-wrapper">
          <input
            type="password"
            formControlName="password"
            placeholder="Enter new password"
            [class.error]="hasError('password')"
            #passwordInput
          />
          <span class="eye-icon" (click)="togglePasswordVisibility('password')">
            <i class="fa-solid" [ngClass]="showPassword() ? 'fa-eye-slash' : 'fa-eye'"></i>
          </span>
        </div>
        <small class="error-text" *ngIf="hasError('password') && resetPasswordForm.get('password')?.hasError('required')">
          Password is required
        </small>
        <small class="error-text" *ngIf="hasError('password') && resetPasswordForm.get('password')?.hasError('minlength')">
          Password must be at least 8 characters
        </small>
        <small class="error-text" *ngIf="hasError('password') && resetPasswordForm.get('password')?.hasError('pattern')">
          Password must contain uppercase, lowercase, number and special character
        </small>
      </div>

      <div class="form-group">
        <label>Confirm Password</label>
        <div class="password-wrapper">
          <input
            type="password"
            formControlName="confirmPassword"
            placeholder="Confirm new password"
            [class.error]="hasError('confirmPassword')"
            #confirmPasswordInput
          />
          <span class="eye-icon" (click)="togglePasswordVisibility('confirmPassword')">
            <i class="fa-solid" [ngClass]="showConfirmPassword() ? 'fa-eye-slash' : 'fa-eye'"></i>
          </span>
        </div>
        <small class="error-text" *ngIf="hasError('confirmPassword') && resetPasswordForm.get('confirmPassword')?.hasError('required')">
          Please confirm your password
        </small>
        <small class="error-text" *ngIf="hasError('confirmPassword') && resetPasswordForm.hasError('passwordMismatch') && !resetPasswordForm.get('confirmPassword')?.hasError('required')">
          Passwords do not match
        </small>
      </div>

      <div class="password-requirements">
        <p class="requirements-title">Password must contain:</p>
        <ul>
          <li [class.valid]="hasUpperCase()">
            <i class="fa-solid" [ngClass]="hasUpperCase() ? 'fa-check-circle' : 'fa-circle'"></i>
            At least one uppercase letter
          </li>
          <li [class.valid]="hasLowerCase()">
            <i class="fa-solid" [ngClass]="hasLowerCase() ? 'fa-check-circle' : 'fa-circle'"></i>
            At least one lowercase letter
          </li>
          <li [class.valid]="hasNumber()">
            <i class="fa-solid" [ngClass]="hasNumber() ? 'fa-check-circle' : 'fa-circle'"></i>
            At least one number
          </li>
          <li [class.valid]="hasSpecialChar()">
            <i class="fa-solid" [ngClass]="hasSpecialChar() ? 'fa-check-circle' : 'fa-circle'"></i>
            At least one special character
          </li>
          <li [class.valid]="hasMinLength()">
            <i class="fa-solid" [ngClass]="hasMinLength() ? 'fa-check-circle' : 'fa-circle'"></i>
            Minimum 8 characters
          </li>
        </ul>
      </div>

      <div class="success-message" *ngIf="successMessage()">
        <i class="fa-solid fa-circle-check"></i>
        {{ successMessage() }}
      </div>

      <div class="error-message" *ngIf="errorMessage()">
        <i class="fa-solid fa-circle-exclamation"></i>
        {{ errorMessage() }}
      </div>

      <button type="submit" class="btn-submit" [disabled]="submitting()">
        <span *ngIf="!submitting()">Reset Password</span>
        <span *ngIf="submitting()">
          <i class="fa-solid fa-spinner fa-spin"></i> Resetting...
        </span>
      </button>

      <div class="back-to-login">
        <a routerLink="/login">
          <i class="fa-solid fa-arrow-left"></i> Back to Login
        </a>
      </div>
    </form>
  </div>
</div>
